(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;window.postMessage==null||(c=function(){var a,b,c,d;c=document.documentElement.childNodes,d=[];for(a=0,b=c.length;a<b;a++)l=c[a],l.nodeType===1&&d.push(l);return d}()[0],D="http://copypasta.heroku.com",f=document.createElement("link"),f.rel="stylesheet",f.href=D+"/stylesheets/compiled/copypasta.css",c.appendChild(f),a=false,h=false,g=false,m={},window.copypasta=e={$:false,page_id:window.copypasta_page_id},e.debug=window.copypasta_debug||window.location.hash.indexOf("debug")>0,j=function(a){if(e.debug)return console.debug(a)},p={indicator:"copy-pasta-edit-indicator",dialog:"copy-pasta-dialog",iframe:"copy-pasta-iframe",overlay:"copy-pasta-overlay"},v={indicator:"#"+p.indicator,dialog:"#"+p.dialog,btn:".copy-pasta-button",active:".copy-pasta-active",iframe:"#"+p.iframe,overlay:"#"+p.overlay},d="<div id=\""+p.dialog+"\" class=\"copy-pasta-loading\"><div id=\""+p.overlay+"\"></div><iframe frameborder=\"no\"id=\""+p.iframe+"\" scrolling=\"no\"></iframe></div>",r=function(){a(v.indicator).length===0&&(a("body").append("<div id=\""+p.indicator+"\"><p>click to correct</p></div>"),a(v.indicator).bind("mouseout",i),a(v.indicator).bind("click",t));return a(v.indicator)},k=function(b){a(v.dialog).length===0&&a("body").append(d),b!=null&&(a(v.overlay).show(),j("Overlay shown"),b=b+"&"+Math.random(),e.debug&&(b+="#debug"),j("Loading iframe: "+b),a(v.iframe).attr("src",b));return a(v.dialog)},n=function(){return a.modal.close()},o=function(){return a(v.overlay).fadeOut(function(){return j("Overlay hidden")})},y=function(a){return k().animate({height:a.h+"px"})},b=function(){var b,c;b=a(this).offset(),b.top=b.top+"px",b.left=b.left+"px",c={width:a(this).outerWidth()+"px",height:a(this).outerHeight()+"px"},r().css(c).css(b).show();return h=this},i=function(){r().hide();return h=false},E=function(c){return a(v.active+" "+c).live("mouseover",b)},t=function(){a.fn.modal||e.modal_init(a);return C("copy-pasta-lightbox").modal({escClose:true,overlayClose:true,overlayId:"copy-pasta-lightbox-overlay",containerId:"copy-pasta-lightbox-container",opacity:70,position:["10%",0]})},C=function(a){var b,c;l=h,(c=l.original_text)!=null?c:l.original_text=l.innerHTML,r().addClass("loading"),m.new_edit={"edit[original]":l.original_text,"edit[proposed]":l.original_text,"edit[url]":window.location.href,"edit[element_path]":e.getElementCssPath(l,g)},b=k("http://copypasta.heroku.com/edits/new?view=framed&url="+escape(window.location.href)+"&page[key]="+escape(e.page_id)),a!=null&&b.attr("class",a);return b},u=function(a){if(a!=null&&m[a]!=null)return B({label:"form_data",data:m[a]})},B=function(b){j("Parent send: "+b.label+" to http://copypasta.heroku.com"),b=JSON.stringify(b);return a(v.iframe).get(0).contentWindow.postMessage(b,"http://copypasta.heroku.com")},x=function(a){var b;if(a.origin!=="http://copypasta.heroku.com")j(a);else{b=JSON.parse(a.data),j("Parent receive: "+b.label+" from "+a.origin);if(b.label==="ready"){if(!u(b.form_id))return o()}else{if(b.label==="form_data_loaded")return o();if(b.label==="finished")return n();if(b.label==="resize")return y(b)}}},s=function(){var b,c,d,e;j("Using jquery version "+a.fn.jquery),e=["p","li","h1","h2","h3","h4","h5"];for(c=0,d=e.length;c<d;c++)b=e[c],E(b);a(v.btn+".off").live("click",function(){var b;q.load(),b=a(this),b.removeClass("off").addClass("on");return g=a(b.attr("href")).addClass("copy-pasta-active").get(0)}),a(v.btn+".on").live("click",function(){var b;b=a(this),b.removeClass("on").addClass("off"),a(b.attr("href")).removeClass("copy-pasta-active");return g=false});if(window.addEventListener!=null)return window.addEventListener("message",x,false);if(window.attachEvent!=null)return window.attachEvent("onmessage",function(){return x(event)})},A=[{test:function(){return(a=window.jQuery)&&window.jQuery.fn&&window.jQuery.fn.jquery>"1.3"},src:"http://copypasta.heroku.com/javascripts/jquery-1.4.2.min.js",callback:function(){return(e.$=a=window.jQuery).noConflict(1)}},{test:function(){return e.getElementCssPath&&window.jQuery&&window.jQuery.fn.lightbox_me},src:"http://copypasta.heroku.com/javascripts/utils.js"},{test:function(){return window.JSON},src:"http://copypasta.heroku.com/javascripts/json2.min.js"}],A.load=function(a,b){var d,e,f,g;f=function(){var b,c,d;d=[];for(b=0,c=a.length;b<c;b++)e=a[b],e.state!=null||d.push(e);return d}();if(!(f.length===0)){d=f.pop(),d.state="pending",g=document.createElement("script"),g.type="text/javascript",g.src=d.src,g.onload=g.onreadystatechange=function(){var c,e;c=this.readyState;if(!d.loaded&&(!c||c==="loaded"||c==="complete")){d.state="loaded",d.callback!=null&&d.callback(),f=function(){var b,c,d;d=[];for(b=0,c=a.length;b<c;b++)e=a[b],e.state!=="loaded"&&d.push(e);return d}();if(f.length===0)return b()}},a.length>0&&A.load(a,b);return c.appendChild(g)}},q=["translucent-blue.png","translucent-black.png","loading.gif"],q.load=function(){var a,b,c,d,e;e=[];for(c=0,d=q.length;c<d;c++)a=q[c],b=new Image,e.push(b.src=D+"/images/"+a);return e},w=function(){var a,b,c;c=[];for(a=0,b=A.length;a<b;a++)z=A[a],z!=null&&!z.test()&&c.push(z);return c}(),w.length>0?A.load(w,s):s())}).call(this)