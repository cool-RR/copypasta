(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;a=false,f=false,k=false,window.copypasta=d={},i={indicator:"copy-pasta-edit-indicator",dialog:"copy-pasta-dialog",iframe:"copy-pasta-iframe",cancel_btn:"copy-pasta-cancel"},n={indicator:"#"+i.indicator,dialog:"#"+i.dialog,btn:".copy-pasta-button",active:".copy-pasta-active",cancel_btn:"#"+i.cancel_btn,iframe:"#"+i.iframe},c="<div id=\""+i.dialog+"\"><iframe frameborder=\"no\" style=\"margin: 0px; padding: 0px; width: 100%; height: 300px; z-index: 2;\" id=\""+i.iframe+"\" scrolling=\"no\"></iframe><input type=\"button\" class=\"close\" id=\"copy-pasta-cancel\" style=\"display:none;\"></div>",l=function(){a(n.indicator).length===0&&a("body").append("<div id=\""+i.indicator+"\"><p>click to correct</p></div>");return a(n.indicator)},h=function(b){b!=null&&(b=b+"&"+Math.random()),a(n.dialog).length===0&&a("body").append(c),k=false,b!=null&&a(n.iframe).attr("src",b);return a(n.dialog)},b=function(){var b,c;b=a(this).offset(),b.top=b.top+"px",b.left=b.left+"px",c={width:a(this).outerWidth()+"px",height:a(this).outerHeight()+"px"},l().css(c).css(b).show();return f=this},g=function(){l().hide();return f=false},v=function(c){return a(n.active+" "+c).live("mouseover",b)},u=function(){var a,b,c;b=f,(c=b.original_text)!=null?c:b.original_text=b.innerHTML,l().addClass("loading"),a={"edit[original]":b.original_text,"edit[proposed]":b.original_text,"edit[url]":window.location.href},s({label:"form_data",data:a});return h("http://copypasta.heroku.com/edits/new?view=framed&url="+escape(window.location.href)).lightbox_me({closeClick:false,closeEsc:false})},t=[],s=function(b){return k?a(n.iframe).get(0).contentWindow.postMessage(JSON.stringify(b),"http://copypasta.heroku.com"):t.push(b)},r=function(){var a,b,c;for(b=0,c=t.length;b<c;b++)a=t[b],s(a);return t=[]},j=function(b){var c;if(!(b.origin!=="http://copypasta.heroku.com")){c=JSON.parse(b.data);if(c.label==="ready"){k=true;return r()}if(c.label==="finished"){a(n.btn+".on").click();return h().find(n.cancel_btn).click()}if(c.label==="resize")return a(n.iframe).animate({height:c.h+"px"})}},m=function(){var b,c,d,e;lightbox_me_init(a),e=["p","li","h1","h2","h3","h4","h5"];for(c=0,d=e.length;c<d;c++)b=e[c],v(b);a(n.indicator).live("mouseout",g),a(n.indicator).live("click",u),a(n.btn+".off").live("click",function(){var b;b=a(this),b.removeClass("off").addClass("on");return a(b.attr("href")).addClass("copy-pasta-active")}),a(n.btn+".on").live("click",function(){var b;b=a(this),b.removeClass("on").addClass("off"),a(b.attr("href")).removeClass("copy-pasta-active");return false});if(window.addEventListener!=null)return window.addEventListener("message",j,false);if(window.attachEvent!=null)return window.attachEvent("onmessage",function(){return j(event)})},q=[{test:function(){return window.jQuery&&window.jQuery.fn&&window.jQuery.fn.jquery>"1.4.2"},src:"http://copypasta.heroku.com/javascripts/jquery-1.4.2.min.js",callback:function(){return(a=window.jQuery).noConflict(1)}},{test:function(){return window.jQuery&&window.jQuery.fn.lightbox_me},src:"http://copypasta.heroku.com/javascripts/jquery.lightbox_me.min.js"},{test:function(){return window.JSON},src:"http://copypasta.heroku.com/javascripts/json2.min.js"}],q.load=function(a,b){var c,d,e,f;e=function(){var b,c,e;e=[];for(b=0,c=a.length;b<c;b++)d=a[b],d.state!=null||e.push(d);return e}();if(!(e.length===0)){c=e.pop(),c.state="pending",f=document.createElement("script"),f.type="text/javascript",f.src=c.src,f.onload=f.onreadystatechange=function(){var d,f;d=this.readyState;if(!c.loaded&&(!d||d==="loaded"||d==="complete")){c.state="loaded",c.callback!=null&&c.callback(),e=function(){var b,c,d;d=[];for(b=0,c=a.length;b<c;b++)f=a[b],f.state!=="loaded"&&d.push(f);return d}();if(e.length===0)return b()}},a.length>0&&q.load(a,b);return document.documentElement.childNodes[0].appendChild(f)}},o=function(){var a,b,c;c=[];for(a=0,b=q.length;a<b;a++)p=q[a],p!=null&&!p.test()&&c.push(p);return c}(),o.length>0?q.load(o,m):m(),e=document.createElement("link"),e.rel="stylesheet",e.href="http://copypasta.heroku.com/stylesheets/compiled/copypasta.css",document.documentElement.childNodes[0].appendChild(e)}).call(this)